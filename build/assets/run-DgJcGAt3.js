import{_ as k}from"./AppLayout.vue_vue_type_script_setup_true_lang-Cmd2bEEB.js";import{d as x,x as v,p as b,y as w,a as o,o as i,e as r,u as n,g as y,w as c,b as t,k as p,I as E,t as f,W as C,i as N,F as $}from"./app-DP28Mstu.js";import{_ as B,a as U}from"./AppPageTitle.vue_vue_type_script_setup_true_lang-DcF92J2B.js";import{_ as V}from"./Progress.vue_vue_type_script_setup_true_lang-BtQpru0T.js";import{_ as j}from"./Button.vue_vue_type_script_setup_true_lang-BSeTgO86.js";import"./utils-BSfSTJJn.js";import"./index-Cc0VYeQ3.js";import"./createLucideIcon-D8MTOjv4.js";import"./x-Brxy_dM3.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BkZNvy2m.js";import"./usePrimitiveElement-CgzIm-HW.js";import"./Collection-Cd6XSlzf.js";import"./utils-SADwiPWk.js";import"./check-Fhtre2rC.js";import"./chevron-up-BYpCT4jK.js";import"./circle-oLloqKHD.js";import"./sun-CslGCefH.js";import"./nullish-CHIgUVhi.js";const z={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},F={class:"mt-4"},M={class:"flex items-center justify-center mt-2"},S={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},D={key:1,class:"mr-2 text-sm"},P={key:0,class:"flex items-center justify-center mt-4"},re=x({__name:"run",setup(R){const _=[{title:"پنل مدیریت",href:"/dashboard"},{title:"پشتیبان‌گیری",href:"/backup"}],g=v({}),e=b({isUpdating:!1,next_step:null,percentage:0,message:"در حال بررسی وضعیت سیستم...",isError:!1});function l(){g.post(route("admin.backup.run"),{showProgress:!1,onStart:()=>{e.isUpdating=!0},onSuccess:a=>{const{message:s,step:m,next_step:u,success:d,percentage:h}=a.props.back_response;if(e.message=s,e.next_step=u,e.percentage=h,e.step=m,d||(e.isError=!0),m==="finished"){window.location.href=route("admin.backup.list");return}u&&d&&l()},onError:a=>{e.message="خطایی رخ داد. لطفا دوباره تلاش کنید.",e.isUpdating=!1,e.isError=!0}})}return w(()=>{l()}),(a,s)=>(i(),o($,null,[r(n(y),{title:"پشتیبان‌گیری"}),r(k,{breadcrumbs:_},{default:c(()=>[t("div",z,[r(B,{icon:"DatabaseBackup",title:"پشتیبان‌گیری",subtitle:"در این صفحه می توانید وضعیت پشتیبان‎‌گیری را مشاهده کنید."}),t("div",F,[r(n(V),{"is-error":e.isError,"model-value":e.percentage},null,8,["is-error","model-value"]),t("div",M,[e.isError?p("",!0):(i(),o("svg",S,s[1]||(s[1]=[t("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[t("path",{"stroke-dasharray":"16","stroke-dashoffset":"16",d:"M12 3c4.97 0 9 4.03 9 9"},[t("animate",{fill:"freeze",attributeName:"stroke-dashoffset",dur:"0.3s",values:"16;0"}),t("animateTransform",{attributeName:"transform",dur:"1.5s",repeatCount:"indefinite",type:"rotate",values:"0 12 12;360 12 12"})]),t("path",{"stroke-dasharray":"64","stroke-dashoffset":"64","stroke-opacity":"0.3",d:"M12 3c4.97 0 9 4.03 9 9c0 4.97 -4.03 9 -9 9c-4.97 0 -9 -4.03 -9 -9c0 -4.97 4.03 -9 9 -9Z"},[t("animate",{fill:"freeze",attributeName:"stroke-dashoffset",dur:"1.2s",values:"64;0"})])],-1)]))),t("span",{class:E(["mx-2 text-sm",e.isError&&"text-red-500"])},f(e.message),3),e.isError?p("",!0):(i(),o("span",D,f(e.percentage)+"%",1))]),e.isError?(i(),o("div",P,[r(n(j),{variant:"outline",onClick:s[0]||(s[0]=m=>n(C).visit(a.route("admin.backup.list")))},{default:c(()=>[r(U,{name:"chevronRight"}),s[2]||(s[2]=N(" بازگشت به صفحه قبل "))]),_:1})])):p("",!0)])])]),_:1})],64))}});export{re as default};
