import{i as T,o as F}from"./index-Cc0VYeQ3.js";import{h as C,g as b}from"./Collection-Cd6XSlzf.js";import{v as h,M as D,G as m,d as S,p as I,c as y,h as N,o as _,w as B,r as x,u as E,z as U}from"./app-DP28Mstu.js";import{u as W,P as k}from"./usePrimitiveElement-CgzIm-HW.js";const A="dismissableLayer.pointerDownOutside",M="dismissableLayer.focusOutside";function L(e,t){const i=t.closest("[data-dismissable-layer]"),s=e.dataset.dismissableLayer===""?e:e.querySelector("[data-dismissable-layer]"),a=Array.from(e.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(i&&(s===i||a.indexOf(s)<a.indexOf(i)))}function R(e,t){var o;const i=((o=t==null?void 0:t.value)==null?void 0:o.ownerDocument)??(globalThis==null?void 0:globalThis.document),s=h(!1),a=h(()=>{});return D(c=>{if(!T)return;const r=async f=>{const p=f.target;if(!(!(t!=null&&t.value)||!p)){if(L(t.value,p)){s.value=!1;return}if(f.target&&!s.value){let O=function(){C(A,e,w)};const w={originalEvent:f};f.pointerType==="touch"?(i.removeEventListener("click",a.value),a.value=O,i.addEventListener("click",a.value,{once:!0})):O()}else i.removeEventListener("click",a.value);s.value=!1}},d=window.setTimeout(()=>{i.addEventListener("pointerdown",r)},0);c(()=>{window.clearTimeout(d),i.removeEventListener("pointerdown",r),i.removeEventListener("click",a.value)})}),{onPointerDownCapture:()=>s.value=!0}}function z(e,t){var a;const i=((a=t==null?void 0:t.value)==null?void 0:a.ownerDocument)??(globalThis==null?void 0:globalThis.document),s=h(!1);return D(o=>{if(!T)return;const c=async r=>{if(!(t!=null&&t.value))return;await m(),await m();const d=r.target;!t.value||!d||L(t.value,d)||r.target&&!s.value&&C(M,e,{originalEvent:r})};i.addEventListener("focusin",c),o(()=>i.removeEventListener("focusin",c))}),{onFocusCapture:()=>s.value=!0,onBlurCapture:()=>s.value=!1}}const l=I({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Q=S({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(e,{emit:t}){const i=e,s=t,{forwardRef:a,currentElement:o}=W(),c=y(()=>{var n;return((n=o.value)==null?void 0:n.ownerDocument)??globalThis.document}),r=y(()=>l.layersRoot),d=y(()=>o.value?Array.from(r.value).indexOf(o.value):-1),f=y(()=>l.layersWithOutsidePointerEventsDisabled.size>0),p=y(()=>{const n=Array.from(r.value),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),u=n.indexOf(v);return d.value>=u}),O=R(async n=>{const v=[...l.branches].some(u=>u==null?void 0:u.contains(n.target));!p.value||v||(s("pointerDownOutside",n),s("interactOutside",n),await m(),n.defaultPrevented||s("dismiss"))},o),w=z(n=>{[...l.branches].some(u=>u==null?void 0:u.contains(n.target))||(s("focusOutside",n),s("interactOutside",n),n.defaultPrevented||s("dismiss"))},o);F("Escape",n=>{d.value===r.value.size-1&&(s("escapeKeyDown",n),n.defaultPrevented||s("dismiss"))});let P;return D(n=>{o.value&&(i.disableOutsidePointerEvents&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(P=c.value.body.style.pointerEvents,c.value.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(o.value)),r.value.add(o.value),n(()=>{i.disableOutsidePointerEvents&&l.layersWithOutsidePointerEventsDisabled.size===1&&(c.value.body.style.pointerEvents=P)}))}),D(n=>{n(()=>{o.value&&(r.value.delete(o.value),l.layersWithOutsidePointerEventsDisabled.delete(o.value))})}),(n,v)=>(_(),N(E(k),{ref:E(a),"as-child":n.asChild,as:n.as,"data-dismissable-layer":"",style:U({pointerEvents:f.value?p.value?"auto":"none":void 0}),onFocusCapture:E(w).onFocusCapture,onBlurCapture:E(w).onBlurCapture,onPointerdownCapture:E(O).onPointerDownCapture},{default:B(()=>[x(n.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),X="focusScope.autoFocusOnMount",Y="focusScope.autoFocusOnUnmount",Z={bubbles:!1,cancelable:!0};function ee(e,{select:t=!1}={}){const i=b();for(const s of e)if(V(s,{select:t}),b()!==i)return!0}function te(e){const t=H(e),i=g(t,e),s=g(t.reverse(),e);return[i,s]}function H(e){const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t}function g(e,t){for(const i of e)if(!K(i,{upTo:t}))return i}function K(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function q(e){return e instanceof HTMLInputElement&&"select"in e}function V(e,{select:t=!1}={}){if(e&&e.focus){const i=b();e.focus({preventScroll:!0}),e!==i&&q(e)&&t&&e.select()}}export{X as A,Z as E,Q as _,ee as a,Y as b,te as c,l as d,V as f,H as g};
